[build]
builder = "nixpacks"
buildCommand = "cat > .env << 'EOF'\nDATABASE_URL=postgresql://dummy:dummy@localhost:5432/dummy\nEOF\n&& cat .env && npm install && npx prisma generate && npm run build:backend"

[deploy]
startCommand = "rm -f .env && npx prisma migrate deploy && node dist/main"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
healthcheckPath = "/api/v1/health"
healthcheckTimeout = 100
